
âŸ¨GnuplotâŸ© â† â€¢Import "Gnuplot.bqn"

âŸ¨JParseâ‡Parse,JExportâ‡ExportâŸ©â†â€¢Import "bqn-libs/json.bqn"
âŸ¨Split , Join,  SplitL, JoinLâŸ©â†â€¢Import "bqn-libs/csv.bqn"
âŸ¨MP, Cholesky,InverseâŸ©â†â€¢Import "bqn-libs/matrix.bqn"
#1â€¿1 MP 2â€¿2â¥Š4
âŸ¨FmtNs, GLine, WMean, Ema, Var, WVar, WStd, GBars, CumBins, CumBinsPct, HBins, Hist, PHistâŸ©â†â€¢Import "pk-libs.bqn"


jsondirâ† "/media/mu6mula/Data/Crypto-Data-Feed/freq-user-data/data/binance/"
LdJson â†{ 
	>JParse â€¢FChars jsondirâˆ¾(âŠ‘ğ•©)âˆ¾"_"âˆ¾(1âŠ‘ğ•©)âˆ¾"-"âˆ¾(ğ•¨)âˆ¾".json"
}
LdJsLc â† {â‹†â¼ Â¯2âŠË˜ ğ•¨ LdJson ğ•©â€¿"USDT"}

#3â†‘ ohlcv â† "8h" LdJson "AVAX"â€¿"USDT"
#10â†‘ 2â€¿3âŠ¸âŠË˜ ohlcv

#################################################################
### Ichimoku Cloud 
#################################################################
Ichimoku â† {
	tenkanNâ€¿kijunNâ€¿senkBNâ€¿cloudNâ†ğ•¨â‹„
	tenkan â† Ã·âŸœ2 +Â´âŒˆâ€¿âŒŠ {(0â¥ŠËœtenkanN-1)âˆ¾ğ• ËË˜ tenkanNâ†•ğ•©}Â¨ â‹ˆËâ‰2â€¿3âŠ¸âŠË˜ğ•©â‹„
	kijun â† Ã·âŸœ2 +Â´âŒˆâ€¿âŒŠ {(0â¥ŠËœkijunN-1)âˆ¾ğ• ËË˜ kijunNâ†•ğ•©}Â¨ â‹ˆËâ‰2â€¿3âŠ¸âŠË˜ğ•©â‹„
	senkouA â† (cloudNâ¥Š0)Â» Ã·âŸœ2 tenkan + kijunâ‹„
	senkouB â† (cloudNâ¥Š0)Â» Ã·âŸœ2 +Â´âŒˆâ€¿âŒŠ {(0â¥ŠËœsenkBN-1)âˆ¾ğ• ËË˜ senkBNâ†•ğ•©}Â¨ â‹ˆËâ‰2â€¿3âŠ¸âŠË˜ğ•©â‹„
	tenkanâ€¿kijunâ€¿senkouAâ€¿senkouB
}

XStra â† { 
	tenkanNâ€¿kijunNâ€¿senkBNâ€¿cloudNâ†ğ•¨â‹„
	ohlcv â† ğ•©â‹„
#	tenkanNâ€¿kijunNâ€¿senkBNâ€¿cloudNâ†20â€¿60â€¿120â€¿30 
	tenkanâ€¿kijunâ€¿senkouAâ€¿senkouB â† tenkanNâ€¿kijunNâ€¿senkBNâ€¿cloudN Ichimoku ohlcv
#	tenkanâ€¿kijunâ€¿senkouAâ€¿senkouB â† 20â€¿60â€¿120â€¿30 Ichimoku ohlcv
	senkouUpâ€¿senkouDn â† âŒˆâ€¿âŒŠ {ğ• Â´ ğ•©}Â¨ < senkouAâ€¿senkouB
#	senkouUp â† senkouA âŒˆ senkouB
#	senkouDn â† senkouA âŒŠ senkouB


#PlotIchimoku â† {
#	baseâ€¿quoteâ†ğ•¨â‹„
#	timeframeâ†ğ•©â‹„
	
#	dcv â†500â†‘baseâ€¿quote LoadCandles timeframeâ‹„
	closeâ†Â¯2âŠË˜ohlcvâ‹„
	lnclose â† â‹†â¼ close
	xenter â† (close > senkouUp) âˆ§ (tenkan > kijun) âˆ§ (close > tenkan)
	xinsig â† (âŠ¢âˆ§(Â¬Â»)) xenter
	xexit â† (close < kijun)
	posinxâ‡ /xinsig
	poslensâ‡1â†“(((+Â´âˆ˜Â¬âˆ¨`)))Â¨ (+`xinsig) âŠ” xexit
	posoutxâ‡ ((â‰ ohlcv)-1)âŒŠposinx+poslens
	xio â‡ (posinxâ‰posoutx) 
	cio â‡ xio âŠ close 
	pnlâ‡--Ë â‹†â¼ cio
	Â¯3â†‘ cumpnlâ‡+`pnl
	#â‰xioâˆ¾cioâˆ¾pnlâ‰cumpnl
}

#20â€¿60â€¿120â€¿30 XStra ohlcv

########################################
### Test TOP 100 coins 

top100â†âŸ¨"1000SATS","AAVE","ADA","ALGO","APT","ARB","ASTR","ATOM","AVAX","AXL","AXS","BCH","BLUR","BNB","BONK","BTC","CAKE","CFX","CHZ","DOGE","DOT","DYM","EGLD","ENJ","ENS","EOS","ETC","ETH","FIL","FLOW","FTM","GALA","GNO","GRT","HBAR","ICP","ILV","IMX","INJ","IOTA","JUP","KAVA","KLAY","KSM","LDO","LINK","LRC","LTC","LUNA","LUNC","MANA","MANTA","MATIC","MINA","MKR","NEAR","NEO","OP","ORDI","OSMO","PENDLE","PYTH","QNT","RNDR","ROSE","RUNE","SAND","SEI","SHIB","SNX","SOL","STX","SUI","THETA","TIA","TRX","UNI","USDC","VET","WOO","XLM","XRP","XTZ","ZIL"âŸ©
#(âˆ¾âŸœ"/USDT")Â¨ top100 
# 20â€¿60â€¿120â€¿30âŠ¸XStraÂ¨ "8h"âŠ¸LdJsonÂ¨ (â‹ˆâŸœ"USDT")Â¨ top100 
res â† top100 â‰Ë˜{âŠ‘Â¯1â†‘ğ•©.cumpnl}Â¨ 20â€¿60â€¿120â€¿30âŠ¸XStraÂ¨ "8h"âŠ¸LdJsonÂ¨ (â‹ˆâŸœ"USDT")Â¨ top100 

( (â‹1âŠ¸âŠ‘Ë˜)âŠâŠ¢) res

3â†‘ ohlcv â† "8h" LdJson "AVAX"â€¿"USDT"

#	colâ€¿balâ€¿lesAâ€¿lesB â† 30â€¿60â€¿120 Ichimoku dcvâ‹„
	ixs â† â†•â‰ ohlcvâ‹„
#		multiplot layout 2,1 scale 2,1
	plt â† Gnuplot "
		title 'Ichimoku Cloud' font ',18'
		terminal wxt size 1800,900
		y2range [-1:10]
		y2tics 0.20 nomirror tc lt 2
		grid
		style line 5 lt rgb 'cyan' lw 3 pt 6"
	plt.Plot (â‰>ixsâ€¿senkouAâ€¿senkouB)â€¿" with filledcurves fs solid 0.1"
	plt.Plot (â‰>ixsâ€¿close)â€¿"lw 1 lc rgb 'black' with lines"
	plt.Plot (â‰>ixsâ€¿tenkan)â€¿"lw 1 lc rgb '#5555CC' with lines"
	plt.Plot (â‰>ixsâ€¿kijun)â€¿"lw 1 lc rgb 'red' with lines"
	plt.Plot (â‰>ixsâ€¿senkouA)â€¿"lw 1 lc rgb 'gray' with lines"
	plt.Plot (â‰>ixsâ€¿senkouB)â€¿"lw 1 lc rgb 'gray' with lines"
	plt.Plot (â‰>posoutxâ€¿cumpnl)â€¿"lw 5 lc rgb 'orange' with lines axes x1y2"
	"gnuplot-ichimoku-1.txt" â€¢file.Chars plt.Debug @
	â€¢SH "gnuplot"â€¿"-persist"â€¿"gnuplot-ichimoku-1.txt"
}
#"BTC"â€¿"USDT" PlotIchimoku "1d"
###
