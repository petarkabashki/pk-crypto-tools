# Comma-separated values (.csv)
âŸ¨
  FmtNs, GLine, WMean , Ema, Var, WVar, WStd, GBars, CumBins, CumBinsPct, HBins, Hist, PHist
âŸ©â‡


âŸ¨GnuplotâŸ© â† â€¢Import "Gnuplot.bqn"

#################################################################
###  Statistical Functions
#################################################################

### Rolling Mean, tested against Pandas .rolling().mean()
WMeanâ† {+`(ğ•©-(-ğ•¨)â†“(ğ•¨â¥Š0)âˆ¾ğ•©)Ã·ğ•¨}
2 WMean 1+â†•100
1+â†•100
Â¯4â†‘3 WMean â‹†âŸœ1.2 â†•20

### EMA 
Emaâ†{kâ†2Ã·1+ğ•¨â‹„{(kÃ—ğ•©)+ğ•¨Ã—1-k}`ğ•©} 
50 Ema â†•1e1

### Variance Welford's method, tested against Numpy np.var([])
# https://jonisalonen.com/2013/deriving-welfords-method-for-computing-variance/
Varâ†{nâ€¿mâ€¿sâ†1â€¿0â€¿0{
  kâ€¿mâ€¿sâ†ğ•©â‹„
    newMâ†m+(ğ•¨-m)Ã·kâ‹„
	  (k+1)â€¿newMâ€¿(s+(ğ•¨-newM)Ã—(ğ•¨-m))
	}Â´âŒ½ğ•©â‹„
	sÃ·n-1}
 Var 10Ã·Ëœ1+â†•2
Var â‹†âŸœ1.2 â†•20
âŠ‘2+â†•10

### ROlling Variance, tested against Pandas.rolling().var(ddof=1)
# Source: https://jonisalonen.com/2014/efficient-and-accurate-rolling-standard-deviation/
# Another similar algorithm here () https://www.dfki.de/fileadmin/user_upload/import/7051_131008_Memory_and_Processing_Efficient_Formula_for_Moving_Variance_Calculation_in_EEG_and_EMG_Signal_Processing_NEUROTECHNIX_Krell.pdf
WVar â† {vâ†Var ğ•¨â†‘ğ•©â‹„
 mmâ†(Â»+âŠ¢) ğ•¨ WMean ğ•©â‹„
 x0â†(ğ•¨â¥Š0)Â»ğ•©â‹„
 zâ†(ğ•©-x0)Ã—(ğ•©+x0-mm)â‹„
 (0â¥ŠËœğ•¨-1)âˆ¾ (ğ•¨-1)Ã·Ëœ +`(vÃ—ğ•¨)âˆ¾ğ•¨â†“zâ‹„
} 
3 WVar â‹†âŸœ1.2 â†•20

### Rolling Std, Tested against Pandas.rolling(w).std(ddof=1)
WStd â† âˆšâˆ˜WVar

Â¯4â†‘3 WStd â‹†âŸœ1.2 â†•20

#-âŸœÂ» 
### Bins and Quantiles

GBars â† {
	plt â† Gnuplot "
		title '"âˆ¾ğ•¨âˆ¾"' font ',18'
		terminal wxt size 1300,600
		style line 5 lt rgb 'cyan' lw 3 pt 6"
	plt.Plot ğ•©â€¿"using 1:2 with boxes fillstyle pattern 5 title ''"
	"gnuplot-histogram-1.txt" â€¢file.Chars plt.Debug @
	â€¢SH "gnuplot"â€¿"-persist"â€¿"gnuplot-histogram-1.txt"
} 
### Cumulative Bins aka Cumulative Probability Density
CumBins â† {
	soâ†âˆ§ğ•©â‹„
	staâ€¿endâ†0â€¿Â¯1âŠsoâ‹„
  lsâ†sta+((1eÂ¯3Ã·ğ•¨)+1+â†•ğ•¨)Ã—(end-sta)Ã·ğ•¨â‹„
	cuxâ†+Ësoâ‰¤âŒœlsâ‹„
	cux â‰ ls
} 
#âŒ½Ë˜â‰50 CumBins 1000Ã·Ëœ1+â†•100

### Cumulative Distribution Diagram
#"Cumulative Counts" GBars âŒ½Ë˜â‰50 CumBins 1000Ã·Ëœ â‹†âŸœ1.8 1+â†•100
 CumBinsPct â† (((âŠ¢Ã·âŸ¨Â¯1âŸ©âŠ¸âŠ‘)0âŠ¸âŠ)â‰1âŠ¸âŠ)âˆ˜CumBins 
#â‰500 CumBinsPct 1+â†•100
#"Cumulative Percentage" GBars âŒ½Ë˜â‰50 CumBinsPct â‹†âŸœ2.5 1+â†•100
### Bins aka Distribution Histogram
HBins â† {
	soâ†âˆ§ğ•©â‹„
	staâ€¿endâ†0â€¿Â¯1âŠsoâ‹„
  lsâ†sta+((1eÂ¯3Ã·ğ•¨)+1+â†•ğ•¨)Ã—(end-sta)Ã·ğ•¨â‹„
	cuxâ†+Ësoâ‰¤âŒœlsâ‹„
	tvâ†-âŸœÂ» cuxâ‹„ #number of values to take into every bin
	tv /âŠ¸âŠ” soâ‹„
}

#20 HBins â‹†âŸœ2 â†•10
### Histogram
Hist â† "Histogram" GBars (>(+Â´(Ã·â‹ˆâŠ¢)â‰ )Â¨)âˆ˜HBins 
#100 Hist  â‹†âŸœ2 â†•10

### Histogram in %
#30 (â‰âˆ˜>âˆ˜((0âŠ¸âŠ)â‰((âŠ¢Ã·+Â´)1âŠ¸âŠ))âˆ˜â‰âˆ˜>(+Â´(Ã·â‹ˆâŠ¢)â‰ )Â¨)âˆ˜HBins 2000+ â‹†âŸœ3 Â¯5000+â†•10000

PHist â† "Histogram" GBars (â‰âˆ˜>âˆ˜((0âŠ¸âŠ)â‰((âŠ¢Ã·+Â´)1âŠ¸âŠ))âˆ˜â‰âˆ˜>(+Â´(Ã·â‹ˆâŠ¢)â‰ )Â¨)âˆ˜HBins 
#30 PHist 2000+ â‹†âŸœ3 Â¯5000+â†•10000

GLineâ† {
	plt â† Gnuplot "
		title 'Line plot' font ',18'
		terminal wxt size 1300,600
		style line 5 lt rgb 'cyan' lw 5 pt 6"
	plt.Plot (((â†•â‰ )âˆ¾Ë˜âŠ¢)ğ•©)â€¿"lw 1 lc rgb 'blue' with lines"
	"gnuplot-tmp-1.txt"â€¢file.Chars plt.Debug @
	â€¢SH "gnuplot"â€¿"-persist"â€¿"gnuplot-tmp-1.txt"
}

### Format a namespace into a table of key/values
FmtNs â† {kâ†â€¢ns.Keys ğ•©â‹„â‰kâ‰ğ•© â€¢ns.GetÂ¨k}
